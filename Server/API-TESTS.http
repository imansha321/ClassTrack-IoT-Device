# ClassTrack API Test Collection
# Use with REST clients like Postman, Insomnia, or curl

### Variables
@baseUrl = http://localhost:5000/api
@token = YOUR_JWT_TOKEN_HERE

### Health Check
GET http://localhost:5000/health

### ========================
### Authentication
### ========================

### Signup
POST {{baseUrl}}/auth/signup
Content-Type: application/json

{
  "email": "test@school.com",
  "password": "test123",
  "fullName": "Test User",
  "schoolName": "Test School"
}

### Login
POST {{baseUrl}}/auth/login
Content-Type: application/json

{
  "email": "admin@school.com",
  "password": "admin123"
}

### ========================
### Dashboard
### ========================

### Get Dashboard Stats
GET {{baseUrl}}/dashboard/stats
Authorization: Bearer {{token}}

### Get Weekly Attendance
GET {{baseUrl}}/dashboard/attendance/weekly
Authorization: Bearer {{token}}

### Get Hourly Air Quality
GET {{baseUrl}}/dashboard/airquality/hourly
Authorization: Bearer {{token}}

### Get Classrooms Status
GET {{baseUrl}}/dashboard/classrooms
Authorization: Bearer {{token}}

### ========================
### Students
### ========================

### Get All Students
GET {{baseUrl}}/students
Authorization: Bearer {{token}}

### Get Students by Class
GET {{baseUrl}}/students?class=10-A
Authorization: Bearer {{token}}

### Search Students
GET {{baseUrl}}/students?search=Ahmed
Authorization: Bearer {{token}}

### Create Student
POST {{baseUrl}}/students
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "studentId": "STU9999",
  "name": "New Student",
  "class": "10-A",
  "fingerprintData": "FP_DATA_HERE"
}

### Update Student
PUT {{baseUrl}}/students/STUDENT_ID_HERE
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "name": "Updated Name",
  "class": "10-B"
}

### Delete Student
DELETE {{baseUrl}}/students/STUDENT_ID_HERE
Authorization: Bearer {{token}}

### ========================
### Attendance
### ========================

### Get Attendance Records
GET {{baseUrl}}/attendance
Authorization: Bearer {{token}}

### Get Attendance by Date
GET {{baseUrl}}/attendance?date=2024-11-28
Authorization: Bearer {{token}}

### Get Attendance by Class
GET {{baseUrl}}/attendance?class=10-A
Authorization: Bearer {{token}}

### Record Attendance (from ESP32)
POST {{baseUrl}}/attendance
Content-Type: application/json

{
  "studentId": "STU0001",
  "deviceId": "ESP32-101",
  "fingerprintMatch": true,
  "reliability": 98
}

### Get Attendance Stats
GET {{baseUrl}}/attendance/stats
Authorization: Bearer {{token}}

### Get Attendance Stats by Date Range
GET {{baseUrl}}/attendance/stats?startDate=2024-11-01&endDate=2024-11-30
Authorization: Bearer {{token}}

### Get Student Attendance History
GET {{baseUrl}}/attendance/student/STU0001
Authorization: Bearer {{token}}

### Get Student Attendance History (Limited)
GET {{baseUrl}}/attendance/student/STU0001?limit=5
Authorization: Bearer {{token}}

### ========================
### Devices
### ========================

### Get All Devices
GET {{baseUrl}}/devices
Authorization: Bearer {{token}}

### Get Online Devices Only
GET {{baseUrl}}/devices?status=online
Authorization: Bearer {{token}}

### Get Device by ID
GET {{baseUrl}}/devices/DEVICE_ID_HERE
Authorization: Bearer {{token}}

### Create Device
POST {{baseUrl}}/devices
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "deviceId": "ESP32-999",
  "name": "New Sensor",
  "type": "MULTI_SENSOR",
  "location": "Room 999",
  "firmwareVersion": "v2.1.3"
}

### Update Device
PUT {{baseUrl}}/devices/DEVICE_ID_HERE
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "name": "Updated Name",
  "location": "New Location",
  "status": "ONLINE"
}

### Update Device Status (from ESP32)
POST {{baseUrl}}/devices/status
Content-Type: application/json

{
  "deviceId": "ESP32-101",
  "battery": 85,
  "signal": 78,
  "uptime": "45 days"
}

### Delete Device
DELETE {{baseUrl}}/devices/DEVICE_ID_HERE
Authorization: Bearer {{token}}

### ========================
### Air Quality
### ========================

### Get Air Quality Readings
GET {{baseUrl}}/airquality
Authorization: Bearer {{token}}

### Get Air Quality by Room
GET {{baseUrl}}/airquality?room=Room 101
Authorization: Bearer {{token}}

### Get Air Quality by Date Range
GET {{baseUrl}}/airquality?startDate=2024-11-28&endDate=2024-11-28
Authorization: Bearer {{token}}

### Get Air Quality by Room (Summary)
GET {{baseUrl}}/airquality/rooms
Authorization: Bearer {{token}}

### Record Air Quality (from ESP32)
POST {{baseUrl}}/airquality
Content-Type: application/json

{
  "deviceId": "ESP32-102",
  "room": "Room 101",
  "pm25": 42.5,
  "co2": 680,
  "temperature": 24.2,
  "humidity": 51
}

### Get Air Quality Stats
GET {{baseUrl}}/airquality/stats
Authorization: Bearer {{token}}

### Get Air Quality Stats by Date Range
GET {{baseUrl}}/airquality/stats?startDate=2024-11-01&endDate=2024-11-30
Authorization: Bearer {{token}}

### ========================
### Alerts
### ========================

### Get All Alerts
GET {{baseUrl}}/alerts
Authorization: Bearer {{token}}

### Get Unresolved Alerts
GET {{baseUrl}}/alerts?resolved=false
Authorization: Bearer {{token}}

### Get Alerts by Severity
GET {{baseUrl}}/alerts?severity=critical
Authorization: Bearer {{token}}

### Get Alerts by Type
GET {{baseUrl}}/alerts?type=air_quality
Authorization: Bearer {{token}}

### Resolve Alert
PATCH {{baseUrl}}/alerts/ALERT_ID_HERE/resolve
Authorization: Bearer {{token}}

### Delete Alert
DELETE {{baseUrl}}/alerts/ALERT_ID_HERE
Authorization: Bearer {{token}}

### ========================
### Reports
### ========================

### Generate Attendance Report
GET {{baseUrl}}/reports/attendance
Authorization: Bearer {{token}}

### Generate Attendance Report with Filters
GET {{baseUrl}}/reports/attendance?startDate=2024-11-01&endDate=2024-11-30&class=10-A
Authorization: Bearer {{token}}

### Generate Air Quality Report
GET {{baseUrl}}/reports/airquality
Authorization: Bearer {{token}}

### Generate Air Quality Report with Filters
GET {{baseUrl}}/reports/airquality?startDate=2024-11-01&endDate=2024-11-30&room=Room 101
Authorization: Bearer {{token}}

### Generate Device Health Report
GET {{baseUrl}}/reports/devices
Authorization: Bearer {{token}}

### ========================
### WebSocket Testing (JavaScript)
### ========================

# Use this in browser console or Node.js:

const ws = new WebSocket('ws://localhost:8080');

ws.onopen = () => {
  console.log('WebSocket Connected');
  
  // Test attendance
  ws.send(JSON.stringify({
    type: 'attendance',
    deviceId: 'ESP32-101',
    studentId: 'STU0001',
    fingerprintMatch: true,
    reliability: 98
  }));
  
  // Test air quality
  ws.send(JSON.stringify({
    type: 'airquality',
    deviceId: 'ESP32-102',
    room: 'Room 101',
    pm25: 42.5,
    co2: 680,
    temperature: 24.2,
    humidity: 51
  }));
  
  // Test device status
  ws.send(JSON.stringify({
    type: 'device_status',
    deviceId: 'ESP32-103',
    battery: 85,
    signal: 78,
    uptime: '45 days'
  }));
};

ws.onmessage = (event) => {
  console.log('Received:', event.data);
};

ws.onerror = (error) => {
  console.error('WebSocket Error:', error);
};

ws.onclose = () => {
  console.log('WebSocket Disconnected');
};
